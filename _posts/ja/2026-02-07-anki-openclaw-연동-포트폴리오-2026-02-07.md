---
layout: post
title: "Anki OpenClaw 連動ポートフォリオ 2026-02-07"
date: 2026-02-07
categories: [project]
tags: [anki, openclaw, telegram, toeic_ai, moltbot]
lang: ja
---

# Anki x OpenClaw 連動システム ポートフォリオ

![Anki OpenClaw Flow](/images/portfolio/anki-openclaw-flow.svg)

![Anki OpenClaw Metrics](/images/portfolio/anki-openclaw-metrics.svg)

## 1) 目標
- テレグラムで単語を送ると Anki `TOEIC_AI` デッキに自動保存
- 単語の単件/複数件（改行基準）を安定的に処理
- 失敗原因を追跡可能にし、再試行負担を減らす運用構造の確保

## 2) 現在の動作フロー
1. Telegram メッセージ受信
2. OpenClaw ブリッジ ルーティング (`학습:`/`단어:`)
3. 単語パース（改行優先、必要時はカンマ fallback）
4. 各単語の意味/例文補強
5. AnkiConnect でカード保存
6. バッチ保存終了後、結果サマリー応答

## 3) 中核設計ポイント
- コスト効率: 軽量ルートは fast モデル、複雑作業は codex ルート
- 安定性: AnkiConnect 多重 host fallback (`host.docker.internal -> 127.0.0.1 -> localhost`)
- 入力耐久性: literal `\\n` も実改行に変換して複数件保存処理
- 運用性: 失敗時に原因メッセージと漏れ項目をテレグラムへ即時返却

## 4) 解決した課題
- 複数単語が1枚カードに合体していた問題: 改行基準トークン分離を強化
- 単語のみ送信時に意味が空だった問題: 辞書照会 + TOEIC 文脈 fallback 追加
- 外部テストリンク欠落問題: リンク専用ルート/外部 URL 置換ロジック追加

## 5) 運用ガイド（実使用）
- 単件: `학습: be willing to`
- 複数件: 各単語を改行して送信
- 点検: `상태:` または `운영: 액션: 상태; 대상: all`
- リンク: `링크: 가계부` / `링크: 프롬프트`

## 6) セキュリティ/データポリシー
- 機密トークンは `.env` と private リポジトリでのみ管理
- 公開リポには運用データ/個人情報/トークン不含
- 外部送信自動化は承認境界を維持（セーフモード）

## 7) 次のステップ
- 単語品質強化: TOEIC 頻出意味の優先順位辞書拡張
- Anki 保存レポート高度化: 成功/失敗件数 + 失敗単語詳細
- 運用自動化: 夜間点検結果を朝のブリーフィングに統合

---
作成日: 2026. 2. 7.
本ポストは運用ログベースのポートフォリオ文書です。