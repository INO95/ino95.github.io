---
layout: post
title: "Anki OpenClaw 연동 포트폴리오 2026-02-07"
date: 2026-02-07
categories: [portfolio, anki, automation, openclaw]
tags: [anki, openclaw, telegram, toeic_ai, moltbot]
lang: ko
---

# Anki x OpenClaw 연동 시스템 포트폴리오

![Anki OpenClaw Flow](/images/portfolio/anki-openclaw-flow.svg)

![Anki OpenClaw Metrics](/images/portfolio/anki-openclaw-metrics.svg)

## 1) 목표
- 텔레그램에서 단어를 보내면 Anki `TOEIC_AI` 덱에 자동 저장
- 단어 단건/다건(개행 기준) 모두 안정적으로 처리
- 실패 원인을 추적 가능하게 하고 재시도 부담을 줄이는 운영 구조 확보

## 2) 현재 동작 플로우
1. Telegram 메시지 수신
2. OpenClaw 브리지 라우팅 (`학습:`/`단어:`)
3. 단어 파싱 (개행 우선, 필요 시 쉼표 fallback)
4. 각 단어별 뜻/예문 보강
5. AnkiConnect로 카드 저장
6. 배치 저장 종료 후 결과 요약 응답

## 3) 핵심 설계 포인트
- 비용 효율: 경량 라우트는 fast 모델, 복잡 작업은 codex 라우트
- 안정성: AnkiConnect 다중 host fallback (`host.docker.internal -> 127.0.0.1 -> localhost`)
- 입력 내구성: literal `\\n`도 실제 개행으로 변환해 다건 저장 처리
- 운영성: 실패 시 원인 메시지와 누락 항목을 텔레그램으로 즉시 반환

## 4) 해결한 이슈
- 여러 단어가 1장 카드로 합쳐지던 문제: 개행 기준 토큰 분리 강화
- 단어만 보냈을 때 뜻이 비어 있던 문제: 사전 조회 + TOEIC 맥락 fallback 추가
- 외부 테스트 링크 누락 문제: 링크 전용 라우트/외부 URL 치환 로직 추가

## 5) 운영 가이드 (실사용)
- 단건: `학습: be willing to`
- 다건: 각 단어를 줄바꿈해서 전송
- 점검: `상태:` 또는 `운영: 액션: 상태; 대상: all`
- 링크: `링크: 가계부` / `링크: 프롬프트`

## 6) 보안/데이터 정책
- 민감 토큰은 `.env`와 private 저장소에서만 관리
- 공개 리포에는 운영 데이터/개인정보/토큰 미포함
- 외부 발송 자동화는 승인 경계 유지(안전 모드)

## 7) 다음 단계
- 단어 품질 강화: TOEIC 빈출 의미 우선순위 사전 확장
- Anki 저장 리포트 고도화: 성공/실패 건수 + 실패 단어 상세
- 운영 자동화: 야간 점검 결과를 아침 브리핑에 통합

---
작성일: 2026. 2. 7.
본 포스트는 운영 로그 기반 포트폴리오 문서입니다.